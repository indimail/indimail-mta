.TH svscan 8
.SH NAME
svscan \- starts and monitors a collection of services
.SH SYNOPSIS
.B svscan
[
.I directory
]
.SH DESCRIPTION
.B svscan
starts one
.BR supervise (8)
process for each subdirectory of the current directory, up to a limit of 1000
subdirectories.
.B svscan
skips subdirectory names starting with dots.
.BR supervise (8)
must be in
.BR svscan 's
path.

.B svscan
optionally starts a pair of
.BR supervise (8)
processes, one for a subdirectory
.IR s ,
one for
.IR s\fR/\fBlog ,
with a pipe between them. It does this if the name
.I s
is at most 255 bytes long and
.I s\fR/\fBlog
exists. (In versions 0.70 and below, it does this if
.I s
is sticky.)
.B svscan
needs two free descriptors for each pipe.

Every five seconds,
.B svscan
checks for subdirectories again. If it sees a new subdirectory, it starts a
new
.BR supervise (8)
process. If it sees an old subdirectory where a
.BR supervise (8)
process has exited, it restarts the
.BR supervise (8)
process. In the
.B log
case it reuses the same pipe so that no data is lost.

The default scan interval of 5 secs can be changed by setting SCANINTERVAL environment variable. Set SCANINTERVAL
to 0 to disable the automatic scanning of the service directory completely. You
can also send a HUP signal to svscan to force a directory scan.

.B svscan
is designed to run forever. If it has trouble creating a pipe or running
.BR supervise (8),
it prints a message to stderr; it will try again five seconds (or SCANINTERVAL) later.

If
.B svscan
is given a command-line argument
.IR directory ,
it switches to that
.I directory
when it starts.

.B svscan
output can be driven through
.B multilog
or other logger which supervise monitors. If a directory (or symlink to a directory)
named
.B /service/.svscan
exists, then svscan will direct its stdout and stderr to the supervised service run from the
.B /service/.svscan/log
directory. This simplifies
.B svscan
startup scripts and replaces the use of
.BR readproctitle ,
which does not work on some platforms, e.g. FreeBSD 5.1. Redirecting
.B svscan
output through
.B multilog
also provides a much better solution than other
.B svscan
startup scripts which direct output exclusively to console, causing problems to go undetected for a long time if the server is in a
closet somewhere and nobody looks at console.

.SH SEE ALSO
supervise(8),
svc(8),
svok(8),
svstat(8),
svctool(8),
svscanboot(8),
readproctitle(8),
fghack(8),  
pgrphack(8),
multilog(8),
tai64n(8),
tai64nlocal(8),
setuidgid(8),
envuidgid(8),
envdir(8),
softlimit(8),
setlock(8)

http://cr.yp.to/daemontools.html
