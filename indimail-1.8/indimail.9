.TH "IndiMail" "7" "07 Mar 2010" "Manvendra Bhangui" ""
.LL 8i
.SH NAME
IndiMail -\ A Multi-host distributed Mail Server

.SH DESCRIPTION
IndiMail is an messaging platform built using following packages
.IP \[bu] 2
qmail
.sp -1
.IP \[bu]
serialmail
.sp -1
.IP \[bu]
qmailanalog
.sp -1
.IP \[bu]
dotforward
.sp -1
.IP \[bu]
fastforward
.sp -1
.IP \[bu]
mess822
.sp -1
.IP \[bu]
daemontools
.sp -1
.IP \[bu]
ucspi-tcp
.sp -1
.IP \[bu]
Courier IMAP/POP3
.sp -1
.IP \[bu]
Bogofilter - A Bayesian Spam Filter
.sp -1
.IP \[bu]
Fetchmail
.PP
other useful software which are needed on a typical email server

.IP \[bu] 2
pack
.sp -1
.IP \[bu]
unpack
.sp -1
.IP \[bu]
altermime
.sp -1
.IP \[bu]
ripmime
.sp -1
.IP \[bu]
flash
.PP
Apart from providing ESMTP, IMAP, POP3 service, IndiMail provides Management of Virtual
domains. IndiMail works on both 32 / 64 bit Unix platforms.
.PP
IndiMail provides qmail-remote / qmail-local, proxyimap & proxypop3 which are user-location
aware (on which server the user's mailbox lies). This gives IndiMail the ability to distribute
the users across multiple hosts using standard non-proprietary protocols and RFCs. The other
use of user-location aware property is to have a single domain consisting of a heterogeneous
email server environment (with some users on MS Exchange and some on Lotus Notes some on
IndiMail). To distribute mails for users across multiple hosts, IndiMail uses \fBqmail-remote(8)\fR.
\fBqmail-remote(8)\fR gives the ability to distribute the mails using SMTP or QMTP. You can
use the \fBROUTES\fR environment variable to "smtp" or "qmtp" to choose the protocol.
You can have multiple hosts hosting a domain placed geographically anywhere and tied
up by IndiMail. The architecture does not force a filesystem architecture like NFS to be used
to distribute the users. In other words, \fBIndiMail\fR allows you to extend a domain across
multiple servers and hence provide the ability to scale to any number of users. Such a domain
which is extended across multiple servers is called a clustered domain. A clustered domain
consists of multiple mailstore and one or many MySQL servers. A mailstore is a host which has
the user's mail storage in Maildir. The MySQL servers hold user information like path of the
Maildir, user privileges, user aliases and forwardings, user's mailstore. The MySQL servers
can be present on the mailstores itself or as individual servers or as a single server holding
information for all users on all mailstores. The configuration is flexible and is left to the
user so that one can optimize on cost or performance.

When an IMAP or POP3 client logs in through proxyimap/proxypop3, the following takes place:
.IP \[bu] 2
The proxy analyzes the login sequence
.sp -1
.IP \[bu]
Extracts the user name of the user trying to login
.sp -1
.IP \[bu]
Does a lookup query on the local server to find out which server the mailbox of the user
attempting to login lives on This lookup service (named \fBinlookup(8)\fR) runs on mailbox
servers and accepts requests on a well defined FIFO.
.PP
IndiMail uses a highly modified qmail and provides all features needed in a
modern MTA. However, all features have been added by re-using the functions/libraries provide
by stock qmail (stralloc, substdio, alloc, str, env, etc). Detailed feature list of IndiMail
is provided on the website http://www.indimail.org
.PP
IndiMail has two databases

.nr step 1 1
.IP \n[step] 2
local database - Contains all user information, attributes
.sp -1
.IP \n+[step]
central database - Used only when configured as a clustered domain. This database is
refered to as '\fBclusterinfo\fR'.

.PP
For a non-clustered architecture, you need a local MySQL database. To connect to this MySQL
database, you need to have a control file \fBhost\.mysql\fR. This control file contains the
IP address or hostname of the MySQL database corresponding to the \fBlocal database\fR. If
the control file \fBhost\.mysql\fR is missing, programs will use \fIlocalhost\fR to connect
to MySQL. One can also use \fIhost:user:password:socket/port\fR format for \fBhost.mysql\fR.

The local database consists of the following tables

.nr step 1 1
.IP \n[step] 3
indimail
.sp -1
.IP \n+[step]
indibak
.sp -1
.IP \n+[step]
lastauth
.sp -1
.IP \n+[step]
valias
.sp -1
.IP \n+[step]
vlimits
.sp -1
.IP \n+[step]
ip_alias_map
.sp -1
.IP \n+[step]
userquota
.sp -1
.IP \n+[step]
atrn_map
.sp -1
.IP \n+[step]
vlog
.sp -1
.IP \n+[step]
fstab
.sp -1
.IP \n+[step]
vfilter
.sp -1
.IP \n+[step]
mailing_list
.sp -1
.IP \n+[step]
bulkmail

.PP
A clustered domain in IndiMail is achieved by having a central MySQL database called
\fIclusterinfo\fR. \fIclusterinfo\fR stores information about the user's storage server
(mailstore) and each mailstore's individual local MySQL database's connection parameters
(host, user, password, socket or port). This database is also referred to as the
\fBcentral database\fR. It consists of the following tables

.nr step 1 1
.IP \n[step] 2
hostcntrl
.sp -1
.IP \n+[step]
host_table
.sp -1
.IP \n+[step]
dbinfo
.sp -1
.IP \n+[step]
smtp_port
.sp -1
.IP \n+[step]
mgmtaccess
.sp -1
.IP \n+[step]
vpriv
.PP
The table \fIhostcntrl\fR has the fields user, domain and hostid. \fIhostid\fR is a unique
identifier which needs to be assigned to every server on which email accounts need to be
created. These servers are also called \fImailstores\fR. The program \fBhostcntrl(8)\fR
can be used to add, modify, delete entries to the table \fIhostcntrl\fR. The program
\fBvadduser(1)\fR also adds user entries to this table. Each \fIhostid\fR needs to be mapped
to an IP address. This is maintained in the table \fIhost_table\fR. A program called
\fBvhostid(8)\fR can be used to add, modify or delete entries in \fIhost_table\fR.
.PP
To be able to access the \fBcentral database\fR, IndiMail programs need the following control
files in the directory INDIMAIL/control

.nr step 1 1
.IP \n[step] 2
host.master
.sp -1
.IP \n+[step]
host.cntrl
.PP
These control file contains the IP address or hostname of the MySQL database corresponding to
the \fBcentral database\fR. You can also use \fIhost:user:password:socket/port\fR format for
these control files. If you plan to have a master-slave MySQL architecture, you can have
entry in \fIhost.master\fR pointing to the MySQL master database and have entry in
\fIhost.cntrl\fR pointing to the MySQL slave database. With these control files, all indimail
programs ensure that all writes go to the master database and reads happen only from the slave
database. The control files \fIhost.master\fR, \fIhost.cntrl\fR can be overriden by the
environment variables \fBMASTER_HOST\fR and \fBCNTRL_HOST\fR. One can also give
host:user:password:mysql_socket/port as the format for \fIhost.master\fR and \fIhost.cntrl\fR.
.PP
IndiMail uses \fBgethostid(3)\fR and \fBgetaddrinfo(3)\fR to figure out its identity.
\fBgetaddrinfo(3)\fR requires your hosts address to be either resolved by dns or be present
in \fBhosts(5)\fR /etc/hosts. You can bypass \fBgethostid(3)\fR and \fBgetaddrifno(3)\fR by
have your hostid in \fIINDIMAIL/control/hostid\fR and your IP address in
\fBINDIMAIL/control/localiphost\fR.
.PP
In a clustered setup, you can have multiple servers with each server having its own set of
local users. The information for these users are stored in a MySQL database known as the
\fBlocal database\fR. You can have multiple \fBlocal databases\fR with each database serving one
email server. You can also club user information for multiple email servers in a single MySQL
\fBlocal database\fR. This flexibility helps IndiMail achieve scalability. So apart from the
user's location which is maintained in the \fBcentral database\fR, other user attributes like
home directory, gecos, quota, access rights are maintained in another MySQL database called the
\fBlocal database\fR.
.PP
Access to the individual \fBlocal database\fR by indimail programs is made easy by, having the
parameters needed to connect to each of the MySQL \fBlocal datbase\fR, in a table called
\fIdbinfo\fR, on the \fBcentral database\fR. The same information can be maintained in a control
file \fBINDIMAIL/control/mcdinfo\fR. The file \fImcdinfo\fR allows one to maintain and sync
information about each and every \fImailstore\fR on the \fIdbinfo\fR table. The updation
depends on the timestamp of the \fImcdinfo\fR file and \fIdbinfo\fR table. The moment
\fImcdinfo\fR is updated, the same information gets updated in the \fIdbinfo\fR table. The
moment \fIdbinfo\fR gets updated, the file \fImcdinfo\fR on all other \fImailstore\fR (older
than the \fIdbinfo\fR table) gets updated. The entries in \fIdbinfo\fR table / \fImcdinfo\fR
file can be seen by running the \fBdbinfo(8)\fR program. Whenever a new \fImailstore\fR is
added/removed, the entry for the \fImailstore\fR and the corresponding MySQL \fBlocal database\fR
needs to be added/removed in the \fIdbinfo\fR table or \fImcdinfo\fR file. In short, the entries
in the \fIdbinfo\fR table and the \fImcdinfo\fR control file on all servers are kept in sync.
.PP
In case you do not require a multi-host setup, IndiMail does not require \fBcentral database\fR.
Programs just need to connect to the \fBlocal database\fR which can be configured by having the
control file INDIMAIL/control/host.mysql.

.SH Virtual Domains
.PP
IndiMail has an idea of email domains that are "local" and "virtual". Local domains are ones
which primarily match against /etc/passwd. Virtual domains match against domains listed in
the control file INDIMAIL/control/virtualdomains. IndiMail makes use of the INDIMAIL/users/assign
file and \fIvirtualdomains\fR file. The \fIusers/assign\fR file gets compiled into a \fIusers/cdb\fR
file. It is a hashed database to speed searches for patterns. If a pattern is matched then
IndiMail delivers the email to the directory defined in the file using the uid and gid which is
also defined. IndiMail makes use of this method to deliver all virtual domain email as the
single uid/gid indimail/indimail. It also uses it to take delivery instructions from
INDIMAIL/domains/<virtualdomain>/.qmail-default file. Once qmail-local gets the information from the \fIusers/assign\fR file it performs standard .qmail
file processing in the directory. Normal .qmail-<user> files can be used for forwarding, aliases
or invoking programs such as ezmlm. If no matches are found qmail-local looks for a .qmail-default
file. This is the last stage in qmail-local's delivery mechanism. qmail-local uses this file to
invoke the vdelivermail program. This program takes two parameters, the first is not used (it is
there for backward compatibility). The second parameter is the default delivery if a virtual
domain user can not be found. Basically, it can be one of the following

.nr step 1 1
.IP \n[step] 3
Full path to a indimail user directory 
.sp -1
.IP \n+[step]
email address to forward email to
.sp -1
.IP \n+[step]
the string bounce-no-mailbox to bounce the email back to the sender.
.sp -1
.IP \n+[step]
Address in SMTPROUTE format to which \fBvdelivermail\fR should use SMTP to deliver the mail.
e.g.

.EX
indimail.org:192.168.1.55:25
.EE

where indimail.org is the local domain, 192.168.1.55 is the IP address of an SMTP server
for indimail.org and 25 is the SMTP port.

.SH Directory structure
.PP
IndiMail gets it's own home directory. A typical IndiMail installation willl have the following
directories in the directory INDIMAIL.
.TS
l l.
Directory     | Description
_
bin           | All user binaries
sbin          | Binaries required by administrators
lib           | Shared/Development Libraries
include       | Include files for development
users         | assign, cdb file
alias         | System aliases postmaster, mailer-daemon, root
domains       | Virtual domain directories, each having .qmail-default file
control       | Most of IndiMail's configuration file lie here
plugins       | Plugins for qmail-queue
modules       | Loadable modules for flash (ncurses based menu system)
man           | Man pages
doc           | Documentation
mysqldb       | Local MySQL database (MySQL database in data, logs in logs)
boot          | Startup files
autoturn      | Domains supporting ETRN, AUTOTURN support
qscanq        | Directory for virus scanning if qscanq is used
share         | clamd virus signature database
libexec       | Authentication modules for courier-imap
etc           | bogofilter.cf, spam wordlist, tcp.[smtp,imap,pop3].cdb, etc

.TE

.PP
Apart from the above, IndiMail has all logs in the directory /var/log/indimail.
These contain both informational and error logs.

.TS
l l.
Directory       | Description
_
clamd           | clamd virus scanner log
freshclam       | clamd signature update log
qscanq          | qscanq virus scanner log
smtpd.25        | Log for qmail-smtpd running on port 25
smtpd.587       | Log for qmail-smtpd Message Submission Port \fBrfc-2476(5)\fR
smtpd.366       | Log for qmail-smtpd ODMR port \fBrfc-2645(5)\fR.
smtpd.465       | Log for qmail-smtpd on SMTPS port
qmtpd.209       | Log for qmail-qmtpd on QMTP port
qmqpd.628       | Log for qmail-qmqpd on QMQP port
deliver.25      | qmail-send deliver log
fetchmail       | fetchmail log
greylist.1999   | greylist daemon log
imapd.143       | Log for imapd running on port 143
imapd-ssl.993   | Log for imapd running on port 993 (SSL)
proxyIMAP.4143  | Log for IMAP proxy running on port 4143
proxyIMAP.9143  | Log for IMAP proxy running on port 9143 (SSL)
pop3d.110       | Log for pop3d running on port 110
pop3d-ssl.995   | Log for pop3d running on port 995 (SSL)
proxyPOP3.4110  | Log for POP3 proxy running on port 4110
proxyPOP3.9110  | Log for POP3 proxy running on port 9110 (SSL)
indisrvr.4000   | Log for IndiMail administration daemon
inlookup.infifo | Log for inlookup server
pwdlookup       | Log for NSS daemon for password lookups
poppass.106     | Log for poppassd protocol daemon
mysql.3306      | Log for MySQL service
spamlog         | Spam attemtps gets logged here
svscan          | Log for svscan service
.TE

.SH Virtual Domain Directory Structure Layout
IndiMail uses an adaptive directory structure based on a table \fIdir-control\fR which is
automatically managed by the core programs \fBvadduser(1)\fR and \fBvdeluser\fR. The basic
idea is to break up the user Maildir directories across multiple directories and sub
directories so that there are never more than 100 user directories in a single directory.

In a single file system, the default directory setup allows for 62 directories in 3 levels
and 100 user directories per directory. The total number of user directories is equal to
(62 * 100) + (62 * 62 * 100) + (62 * 62 * 62 * 100) = over 24 million directories per filesystem.
This should be more than sufficient for any site and probably goes beyond the technology
of directory structures. 

If you are going to be storing large numbers of user directories, make sure you set your
file system to have a higher than normal percentage of inodes. 

IndiMail will automatically create these directories and sub directories as needed and
populate each directory with up to 100 user accounts. As soon as a directory reaches
100 users it will create the next directory or sub directory and store the new users
directory there. 

You can use the \fBvreorg(8)\fR program to recreate the \fIdir-control\fR table.

.SH Environment Variables
Some IndiMail programs set or use environment variables. The following
table lists these variables and describes their use.
.TS
l l.
Environ  Variable |Program      |Set/Used|Purpose
------------------|-------------|--------|----------------------------------------
QMAILQUEUE        |qmail-smtpd  |used    |Program to be called instead
                  |qmail-inject |        |qmail-queue
                  |new-inject   |        |
                  |condredirect |        |
                  |dot-forward  |        |
                  |fastforward  |        |
                  |filterto     |        |
                  |forward      |        |
                  |maildirserial|        |
                  |ofmipd       |        |
                  |qmail-local  |        |
                  |qmail-qmtpd  |        |
                  |qmail-qmqpd  |        |
                  |qmail-send   |        |
                  |qreceipt     |        |
                  |replier      |        |
                  |rrforward    |        |
------------------|-------------|--------|----------------------------------------
QUEUEPROG         |qmail-multi  |used    |Program to be called to queue message
                  |             |        |default is qmail-queue. You can define
                  |             |        |this to be qmail-qmqpc in order to send
                  |             |        |messages to a to a QMQP server
------------------|-------------|--------|----------------------------------------
CONTROLDIR        |qmail-smtpd  |used    |The directory containing control files.
                  |qmail-remote |        |If not defined qmail_home/control
                  |spawn-filter |        |is used
                  |qmail-local  |        |
                  |ipmeprint    |        |
                  |qmail-newmrh |        |
                  |qmail-send   |        |
                  |qmail-showctl|        |
                  |qmail-spamdb |        |
                  |qmail-todo   |        |
                  |qmail-command|        |
------------------|-------------|--------|----------------------------------------
QUEUEDIR          |qmail-queue  |used    |queue path from where to pick up mails
                  |qmail-clean  |        |for local and remote deliveries
                  |qmail-daemon |        |
                  |qmail-rm     |        |
                  |qmail-send   |        |
                  |qmail-tcpok  |        |
                  |qmail-tcpto  |        |
                  |qmail-todo   |        |
                  |spawn-filter |        |
                  |qmail-lspawn |        |
                  |qmail-rspawn |        |
------------------|-------------|--------|----------------------------------------
ENVRULES          |qmail-smtpd  |used    |Any environment variable(s) can be set
                  |spawn-filter |        |based on senders/recipients matching a
                  |qmail-inject |        |given value.
                  |             |        |smtp 
                  |             |        |REQUIREAUTH, QREGEX, ENFORCE_FQDN_HELO,
                  |             |        |DATABYTES, BADHELOCHECK, BADHELO,
                  |             |        |NODNSCHECK, VIRUSCHECK, SIGNATURES,
                  |             |        |BODYCHECK, BADMAILFROM, DATABYTES_NOTIFY,
                  |             |        |BADMAILFROMPATTERNS, BOUNCEMAIL,
                  |             |        |CUGMAIL, MASQUERADE, DEFAULT_DOMAIN,
                  |             |        |BADRCPTTO, BADRCPTPATTERNS, TARPITCOUNT,
                  |             |        |TARPITDELAY, MAXRECIPIENTS, AUTH_ALL,
                  |             |        |CHECKRELAY, CONTROLDIR, ANTISPOOFING,
                  |             |        |CHECKRECIPIENT SPAMFILTER, LOGFILTER,
                  |             |        |SPAMFILTERARGS, SPAMEXITCODE,
                  |             |        |REJECTSPAM, SPAMREDIRECT, SPAMIGNORE,
                  |             |        |SPAMIGNOREPATTERNS, FILTERARGS,
                  |             |        |QMAILQUEUE, QMAILREMOTE, QMAILLOCAL,
                  |             |        |RELAYCLIENT, QQEH, BADEXT,
                  |             |        |BADEXTPATTERNS, ACCESSLIST, QHPSI,
                  |             |        |REJECTSPAM, REJECTVIRUS
                  |spawn-filter |        |SPAMFILTER, LOGFILTER, SPAMFILTERARGS,
                  |             |        |FILTERARGS, SPAMEXITCODE, REJECTSPAM,
                  |             |        |SPAMREDIRECT, SPAMIGNORE,
                  |             |        |SPAMIGNOREPATTERNS, QREGEX, DATABYTES,
                  |             |        |SMTPROUTE, ONSUCCESS_REMOTE
                  |             |        |ONFAILURE_REMOTE
------------------|-------------|--------|----------------------------------------
QREGEX            |qmail-smtpd  |used    |If set, regex is used to evaluate
                  |spawn-filter |        |patterns in
                  |             |        |  1.badhelo
                  |             |        |  2.blackholedsender
                  |             |        |  3.badmailfrom
                  |             |        |  4.badrcptto
                  |             |        |  5.spamignore
                  |             |        |  6.relaymailfrom
                  |             |        |  7.authdomains
                  |             |        |  8.chkrcptdomains
                  |             |        |  9.accesslist
------------------|-------------|--------|----------------------------------------
EXTRAQUEUE        |qmail-queue  |used    |Extra recipient to be added to the
                  |             |        |recipient list before queueing the mail.
QHPSI             |qmail-queue  |used    |If set enables the Qmail High
                  |             |        |Performance Scanner Interface. This
                  |             |        |should be set to the path of the virus
                  |             |        |scanner. It can also be set to a list of
                  |             |        |space separted plugins starting with the
                  |             |        |keyword plugin:
QHPSIRC           |qmail-queue  |used    |To specify the return code of the virus
                  |             |        |scanner in case of an infection;
                  |             |        |default is 1.
QHPSIMINSIZE      |qmail-queue  |used    |The minimal size of the message to
                  |             |        |invoke the virus scanner; default is 0.
                  |             |        |A typical choice would be
                  |             |        |QHPSIMISIZE=10000 (~10k).
QHPSIMAXSIZE      |qmail-queue  |used    |The maximal size of the message to
                  |             |        |invoke the virus scanner; default is
                  |             |        |unrestricted. A typical choice would be
                  |             |        |QHPPIMAXSIZE=1000000.
QUARANTINE        |qmail-queue  |used    |If set, all mails get redirected to the
                  |             |        |id defined by the environment variable
QHPSIFORWARD      |qmail-queue  |used    |If set, virus infected mails get
                  |             |        |redirectored to the id defined by the
                  |             |        |environment variable
REJECTVIRUS       |qmail-queue  |used    |Sets action to be carried out on
                  |             |        |detection of virus
                  |             |        | 0 Accept infected mails
                  |             |        | 1 Bounce the mail.
                  |             |        | 2 Blackhole the mail.
NULLQUEUE         |qmail-queue  |used    |If set, mail transaction is sent to
                  |             |        |/dev/null without returning an error
                  |             |        |(blackholing)
MAILARCHIVE       |qmail-queue  |used    |mail archival rules based on sender
                  |             |        |or recipient addresses
ENVHEADERS        |qmail-queue  |used    |Contains list of email headers that
                  |             |        |should be available as environment
                  |             |        |variables in qmail-local and
                  |             |        |qmail-remote
LOGHEADERS        |qmail-queue  |used    |Name of control file containing list
                  |             |        |of email headers whose value along
                  |             |        |with header name should be written
                  |             |        |to the file descriptor defined by the
                  |             |        |LOGHEADERFD env variable
LOGHEADERFD       |qmail-queue  |used    |This defines the file descriptor to be
                  |             |        |used for writing when logheaders control
                  |             |        |file or LOGHEADERS environment variable
                  |             |        |is used.
REMOVEHEADERS     |qmail-queue  |used    |Name of control file containing a list
                  |             |        |of email headers that should be removed
                  |             |        |before putting into the queue. If not 
                  |             |        |supplied, qmail-queue uses the control
                  |             |        |file removeheaders.
QQEH              |qmail-queue  |used    |qmail-queue passes this variable into
                  |qmail-local  |        |the queue. qmail-local and qmail-remote
                  |forward      |        |will prepend it to the headers of email
                  |condredirect |        |when it is delivered
PLUGINDIR         |qmail-queue  |used    |Directory in /var/indimail containing
                  |qmail-send   |        |dynamically loadable plugins
QUEUE_PLUGIN_SYMB |qmail-queue  |used    |The function to be called when a
                  |             |        |dynamic virus scanner plugin is loaded
START_PLUGIN      |qmail-send   |used    |List of startup plugins to be loaded
START_PLUGIN_SYMB |qmail-send   |used    |function to be executed from the loaded
                  |qmail-send   |used    |plugins
------------------|-------------|--------|----------------------------------------
QUEUE_COUNT       |qmail-multi  |used    |No of queues setup
QUEUE_START       |qmail-multi  |used    |Number denoting the first queue
QUEUEDIR          |qmail-multi  |set     |queue path where mails are queued
MIN_FREE          |qmail-multi  |used    |Minimum free disk space allowed on the
                  |             |        |QUEUE filesystem after which mails get
                  |             |        |rejected with a temporary error. By
                  |             |        |setting this the IndiMail system becomes
                  |             |        |crashproof as well as bounceproof
SPAMFILTER        |qmail-multi  |used    |Filter program to filter mail before
                  |spawn-filter |        |passing it to qmail-queue
SPAMFILTERARGS    |qmail-multi  |used    |Arguments to be passed to the spam
                  |spawn-filter |        |filter program.
SPAMEXITCODE      |qmail-multi  |used    |Exit code of the spamfilter which
                  |spawn-filter |        |denotes a spam mail.
REJECTSPAM        |qmail-multi  |used    |If set, and if the filter program
                  |spawn-filter |        |returns an exit code matching the value
                  |             |        |of SPAMEXITCODE, the mail is permanently
                  |             |        |rejected
SPAMIGNORE        |qmail-smtpd  |used    |ignore users listed in this control file
                  |spawn-filter |        |
                  |chowkidar    |        |
SPAMIGNOREPATTERNS|qmail-smtpd  |used    |same as above, except that the user list
                  |spawn-filter |        |can have wildcards.
                  |chowkidar    |        |
SPAMREDIRECT      |qmail-multi  |used    |Redirect SPAM tagged mails to the user
                  |spawn-filter |        |specified by this environment variable
FILTERARGS        |qmail-multi  |used    |Arguments with with Filter program will
                  |spawn-filter |        |be called
LOGFILTER         |qmail-smtpd  |used    |If set, any programs called using QMAILQUEUE
                  |spawn-filter |        |or FILTERARGS env variable can use
                  |             |        |the file descriptor 255 where it can log
                  |             |        |additonal status messages to be logged
                  |             |        |in the qmail-smtpd's log file. This
                  |             |        |should be set to a filename which will
                  |             |        |be used by the qmail-spamlog service.
MAKE_SEEKABLE     |qmail-multi  |used    |If set, the pipe used by various
                  |spawn-filter |        |programs to communicate is made
                  |vdelivermail |        |seekable. This improves the performance
                  |autoresponder|        |of filters.
------------------|-------------|--------|----------------------------------------
QMAILLOCAL        |spawn-filter |used    |The mda to call for local deliveries
                  |             |        |(default qmail-local if not defined)
QMAILREMOTE       |spawn-filter |used    |The smtp client to call for remote
                  |             |        |deliveries (default qmail-remote if
                  |             |        |not defined)
------------------|-------------|--------|----------------------------------------
ONSUCCESS_REMOTE  |qmail-remote |used    |if set, program defined by
ONFAILURE_REMOTE  |             |        |ONSUCCESS_REMOTE gets called on
                  |             |        |successful remote deliveries. similarly
                  |             |        |program defined by ONFAILURE_REMOET gets
                  |             |        |called on failed remote deliveries.
                  |             |        |Arguments passed to this program are same
                  |             |        |as that for qmail-remote. These programs
                  |             |        |runs as uid qmailr.
------------------|-------------|--------|----------------------------------------
DEFAULT           |qmail-command|set     |Portion of address matching "-default"
                  |             |        |in a .qmail file name.
DTLINE            |             |        |Delivered-To header field
EXT               |             |        |The address extension
EXT2              |             |        |Portion of EXT following first dash
EXT3              |             |        |Portion of EXT following second dash
EXT4              |             |        |Portion of EXT following third dash
HOST              |             |        |The domain part of the recipient address
HOST2             |             |        |Portion of HOST preceding last dot.
HOST3             |             |        |Portion of HOST preceding second-to-last
                  |             |        |dot
HOST4             |             |        |Portion of HOST preceding third-to-last
                  |             |        |dot
HOME              |             |        |The user's home directory
LOCAL             |             |        |The local part of the recipient address
NEWSENDER         |             |        |Forwarding sender address
                  |             |        |(see "man dot-qmail")
RECIPIENT         |             |        |Envelope recipient address
RPLINE            |             |        |Return-Path header field
SENDER            |             |        |Envelope sender address
UFLINE            |             |        |UUCP-style "From" line
USER              |             |        |The current user
------------------|-------------|--------|----------------------------------------
LOGNAME           |qmail-inject |used    |User name in From header field
MAILHOST          |             |        |Host name in From header field
MAILNAME          |             |        |Personal name in From header field
MAILUSER          |             |        |User name in From header field
NAME              |             |        |Personal name in From header field
QMAILDEFAULTDOMAIN|             |        |Overrides control/defaultdomain
QMAILDEFAULTHOST  |             |        |Overrides control/defaulthost
QMAILHOST         |             |        |Host name in From header field
QMAILIDHOST       |             |        |Overrides control/idhost
QMAILINJECT       |             |        |Specify various  options (see next
                  |             |        |table)
QMAILMFTFILE      |             |        |File containing list of mailing list
                  |             |        |addresses for Mail-Followup-To
                  |             |        |generation
QMAILNAME         |             |        |Personal name in From header field
QMAILPLUSDOMAIN   |             |        |Overrides control/plusdomain
QMAILSHOST        |             |        |Host name in envelope sender address
QMAILSUSER        |             |        |User name in envelope sender address
QMAILUSER         |             |        |User name in From header field
USER              |             |        |User name in From header field
------------------|-------------|--------|----------------------------------------
DKQUEUE           |qmail-dk     |used    |Specifies the path to the qmail-queue
                  |             |        |executable. If this is not set, qmail-dk
                  |             |        |will invoke qmail-multi
DKSIGN            |qmail-dk     |used    |If set to the path of a private key,
                  |             |        |qmail-dk signs the message using the
                  |             |        |private key. This variable should be set
                  |             |        |when a host is authorized to relay.
DKVERIFY          |qmail-dk     |used    |If set, messages are verified and 
                  |             |        |qmail-dk will insert the
                  |             |        |DomainKey-Status header. The behaviour
                  |             |        |depends on the set of letters to which
                  |             |        |DKVERIFY is set. A conservative set of
                  |             |        |letters is DEGIJKfh
DKSIGNOPTIONS     |qmail-dk     |used    |Options to use for dk signing.
                  |dk-filter    |        |
------------------|-------------|--------|----------------------------------------
DKIMQUEUE         |qmail-dkim   |used    |Specifies the path to the qmail-queue
                  |             |        |executable. If this is not set,
                  |             |        |qmail-dkim will invoke qmail-multi
DKIMSIGN          |qmail-dkim   |used    |If set to the path of a private key,
                  |             |        |qmail-dkim signs the message using the
                  |             |        |private key. This variable should be set
                  |             |        |when a host is authorized to relay.
DKIMVERIFY        |qmail-dkim   |used    |If set, messages are verified and
                  |             |        |qmail-dkim will insert the DKIM-Status
                  |             |        |header.
DKIMSIGNOPTIONS   |qmail-dkim   |used    |Options to use for dkim signing
                  |dk-filter    |        |
SIGN_PRACTICE     |qmail-dkim   |used    |For using SSP or ADSP as the signing
                  |             |        |practice
------------------|-------------|-------------------------------------------------
DATABYTES         |qmail-smtpd  |used    |override control/databytes
                  |qmail-inject |used    |override control/databytes
                  |sendmail     |used    |override control/databytes
                  |spawn-filter |used    |override control/databytes
DATABYTES_NOTIFY  |qmail-smtpd  |used    |notification is sent to recipient in
                  |             |        |databyte limit gets exceeded.
------------------|-------------|--------|----------------------------------------
BOUNCEPROCESSOR   |qmail-send   |used    |External bounceprocess to call for
                  |             |        |handling bounces.
BOUNCEQUEUE       |qmail-send   |        |Queue to be used for injecting bounces
TODO_INTERVAL     |qmail-send   |        |To set the minumum time interval between
                  |qmail-todo   |        |two todo runs. By increasing this you
                  |             |        |can reduce the disk IO. But there is a
                  |             |        |latency on mail delivery times 
------------------|-------------|--------|----------------------------------------
TMPDIR            |qmail-multi  |used    |Sets directory to use for temporary
                  |qmail-qfilter|        |files. Default is /tmp
                  |qmail-smtpd  |        |
                  |spawn-filter |        |
PROTO             |sendmail     |used    |Used internally by sendmail -bs flag.
------------------|-------------|--------|----------------------------------------
RELAYCLIENT       |qmail-smtpd  |used    |Ignore control/rcpthosts and append
                  |             |        |value to recipient address. This is used
                  |             |        |for selective relaying to domains not
                  |             |        |listed in rcpthosts.
AUTH_ALL          |             |        |If set, sending mail to all domains will
                  |             |        |require authentication (regardless of
                  |             |        |whether the domain is listed in
                  |             |        |rcpthosts).
REQUIREAUTH       |             |        |If set, 'mail from' is not accepted
                  |             |        |without prior authenticated SMTP.
AUTH_DOMAINS      |             |        |List of comma separated domains whose
                  |             |        |senders will allways require
                  |             |        |authentication to send out mails
                  |             |        |(regardless of whether the domain is
                  |             |        |listed in rcpthosts). Multiple domains
                  |             |        |can also be set with ':' or newline as
                  |             |        |the delimiter. e.g.
                  AUTH_DOMAINS=`cat ~indimail/control/authdomains`
                  |             |        |where authdomains is a file containing
                  |             |        |list of domains one per line.
CHECKRELAY        |             |        |Relay table in MySQL is checked for
                  |             |        |'return path' before sending mails to
                  |             |        |outside domains. Allows users to relay
                  |             |        |mails to foreign domains.
CHECKRECIPIENT    |             |        |Used for checking the status of the
                  |             |        |user. The presence of the user can be
                  |             |        |checked in MySQL (indimail) or
                  |             |        |indimail~/users/recipients.cdb. If the
                  |             |        |control file chkrcptdomains is present,
                  |             |        |then only domains listed in
                  |             |        |chkrcptdomainare checked. If
                  |             |        |chkrcptdomain is absent, |all domains
                  |             |        |are checked. The value of CHECKRECIPIENT
                  |             |        |can be one of the 3 values
                  |             |        |  1.Check MySQL
                  |             |        |  2.Check both MySQL and recipients.cdb
                  |             |        |  3.Check recipients.cdb
MASQUERADE        |             |        |Allows the authenticated userid in AUTH
                  |             |        |SMTP to be different from the 
CUGMAIL           |             |        |Return-Path. Turns of relaying to
ANTISPOOFING      |             |        |foreign domains. Turns of spoofing of
                  |             |        |Return-Path for local users.
MAXRECIPIENTS     |             |        |Maximum number of recipients allowed in
                  |             |        |a single SMTP session.
TARPITCOUNT       |             |        |Maximum number of recipients allowed in
                  |             |        |a single SMTP session after which an
                  |             |        |artificial delay is introduced.
TARPITDELAY       |             |        |No of seconds of delay to be imposed on
                  |             |        |the SMTP session when number of
                  |             |        |recipients in a single SMTP session
                  |             |        |exceeds the value of TARPITCOUNT
BADHELOCHECK      |             |        |Enables checking of badhelo control
                  |             |        |file and validity of the HELO/EHLO
                  |             |        |string as a valid domain.
BADHELO           |             |        |Use this as the filename for bad helo
                  |             |        |REGEX strings.
ENFORCE_FQDN_HELO |             |        |Forces argument to helo/ehlo command to
                  |             |        |be a fully qualified domain name.
BOUNCEMAIL        |             |        |When this is set, SMTP server issues
                  |             |        |this as a message to the client with a
                  |             |        |permanent error.
WARNMAIL          |             |        |Enables warn_mail function.
WARNMAIL          |             |        |X-Spam-Warning: lines inserted in 
.. WARNMAIL9      |             |        |message if these are set.
SHUTDOWN          |             |        |Issues temporary errors for all commands
BADMAILFROM       |             |        |Override the default name for the
                  |             |        |'badmailfrom' control file
BADMAILPATTERNS   |             |        |Override the default name for the
                  |             |        |'badmailpatterns' control file
BADRCPTTO         |             |        |Override the default name for the
                  |             |        |'badrcptto' control file
BADRCPTPATTERNS   |             |        |Override the default name for the
                  |             |        |'badrcptpatterns' control file
BODYCHECK         |             |        |Enables content filtering during a SMTP
                  |             |        |session. The value of BODYCHECK
                  |             |        |environment variable specifies the name
                  |             |        |of the control file containing regex
                  |             |        |patterns to be matched in an email.
VIRUSCHECK        |             |        |Enables in-built virus scanning engine
                  |             |        |in qmail-smtpd. Virus patterns can be
                  |             |        |maintained in the control file
                  |             |        |'signatures'. If set to a value > 1,
                  |             |        |it can be used to call an external
                  |             |        |scan engine for checking viruses and
                  |             |        |bad attachments
                  |             |        |  1.Internal scanner
                  |             |        |  2.Internal+External+attachment scan.
                  |             |        |  3.Internal+attachment scan 
                  |             |        |  4.External+attachment scan
                  |             |        |  5.External scanner
                  |             |        |  6.Attachment scan
SIGNATURES        |             |        |Override the name of the default virus
                  |             |        |pattern control file 'signatures'
HOSTACCESS        |             |        |Defines from which IP address or set of
                  |             |        |IP addresses can mail from a particular
                  |             |        |domain originate.
PARANOID          |             |        |If set, then only pairs having a match
                  |             |        |in the 'hostaccess' control file are
                  |             |        |granted access
DOMAIN_MASQUERADE |             |        |If set, all IP address having a match in
                  |             |        |the 'hostaccess' control file are
                  |             |        |granted access
------------------|-------------|--------|----------------------------------------
STARTTLS          |qmail-smtpd  |used    |Enables the ESMTP STARTTLS extension
SMTPS             |             |        |Turns on the deprecated SMTPS protocol
                  |             |        |on port 465
SERVERCERT        |             |        |File having SSL certificate to be
                  |             |        |presented to clients in TLS encrypted
                  |             |        |sessions. This overrides the control
                  |             |        |file servercert.pem
CLIENTCA          |             |        |A file having list of Certifying
                  |             |        |Authority (CA) certificates that are
                  |             |        |used to verify the client-presented
                  |             |        |certficates during a TLS-encrypted
                  |             |        |session. This overrides the control
                  |             |        |file clientca.pem
CLIENTCRL         |             |        |File having a list of Revocation Lists
                  |             |        |(CRLs). This overrides the control file
                  |             |        |clientcrl.pem
TLSCIPHERS        |             |        |A  set  of OpenSSL cipher strings.
                  |             |        |Multiple ciphers contained in a string
                  |             |        |should be separated by a colon.
------------------|-------------|--------|----------------------------------------
NODNSCHECK        |qmail-smtpd  |used    |If set, the domain part of an email
                  |             |        |address is not verified.
SPFBEHAVIOUR      |             |        |SPF check gets enabled
                  |             |        |  0.SPF Disabled
                  |             |        |  1.Annotate with Received-SPF fields
                  |             |        |  2.Producte temporary failures on DNS
                  |             |        |    lookup problems
                  |             |        |  3.Reject if SPF record says fail
                  |             |        |  4.Strict mode. Reject for 'fail'
                  |             |        |    and 'softfail'
                  |             |        |  5.Reject for 'fail', 'softfail'
                  |             |        |    and 'neutral'
                  |             |        |  6.Reject if no SPF record is
                  |             |        |    available or for syntax error
OPENRELAY         |             |        |If set, qmail-smtpd rejects incoming
                  |             |        |connection with (553 code) the message
                  |             |        |No mail accepted from an open relay
GREYIP            |             |        |If set, will send a UDP packet to
                  |             |        |greydaemon for greylisting
GREETDELAY        |             |        |Time in seconds by which qmail-smtpd
                  |             |        |delays the 220 ESMTP welcome prompt.
                  |             |        |This overrides the greetdelay control
                  |             |        |file.
------------------|-------------|--------|----------------------------------------
SCANCMD           |qscanq       |used    |The virus scanner to run for scanning
                  |             |        |emails. A '%s' in SCANCMD will get
                  |             |        |replaced with the filename in the mess
                  |             |        |directory (file containing the entire
                  |             |        |content of the email)
BADEXT            |qscanq-stdin |used    |Name of control file specifying list of
                  |             |        |prohibited filename extensions in mail.
BADEXTPATTERNS    |qscanq-stdin |used    |Name of control file specifying regex
                  |             |        |patterns of list of prohibited filename
                  |             |        |extensions in mail
SCANDIR           |qscanq       |used    |Name of directory where qscanq will
                  |             |        |create temporary work directory for
                  |             |        |extracting mime from emails.
SCANINTERVAL      |svscan       |used    |Time interval in which svscan should do
                  |             |        |a directory scan to look for new
                  |             |        |services. If set to 0, scanning is
                  |             |        |disabled. However the scan can be
                  |             |        |manually triggered by sending svscan a
                  |             |        |HUP signal. If not set, the default
                  |             |        |scan interval is 5 seconds.
------------------|-------------|--------|----------------------------------------
USE_FSYNC         |qmail-queue  |used    |Causes fsync() to be used for all
                  |qmail-local  |        |open files. This makes IndiMail crash
                  |qmail-send   |        |proof with a minor performance penalty
                  |qmail-todo   |        |
USE_SYNCDIR       |qmail-queue  |used    |Emulates BSD style synchronous
                  |qmail-local  |        |directories.
                  |qmail-send   |        |
                  |qmail-todo   |        |
ROUTES            |qmail-rspawn |used    |If defined as static, control/smtproutes
                  |             |        |or control/qmtproutes is used, else hostcntrl
                  |             |        |is used to set SMTPROUTE / QMTPROUTE
                  |             |        |variables depending on whether
                  |             |        |the ROUTES is defined as "smtp" or "qmtp"
SMTPROUTE         |qmail-rspawn |set     |set to user's mailstore ip if ROUTES is
                  |             |        |defined as "smtp"
QMTPROUTE         |qmail-rspawn |set     |set to user's mailstore ip if ROUTES is
                  |             |        |defined as "qmtp"
SMTPROUTE         |qmail-remote |used    |overrides control/smtproutes
QMTPROUTE         |qmail-remote |used    |overrides control/qmtproutes
AUTH_SMTP         |qmail-remote |used    |Uses Authenticated SMTP on the remote
                  |             |        |SMTP server to push out mails. The
                  |             |        |username and password must be specified
                  |             |        |in smtproutes separated by spaces. e.g.
                  |             |        |test.com:25 postmaster@test.com pass
DOMAINBINDINGS    |qmail-remote |        |Name to be used for the domainbindings
                  |             |        |control file.
AUTHSELF          |qmail-lspawn |used    |Causes PWSTRUCT environment variable to
                  |             |        |be set. This eliminates the need for
                  |             |        |vdelivermail to make connection to the
                  |             |        |database (MySQL). On a high volume
                  |             |        |server, this can significantly improve
                  |             |        |the database performance.
PWSTRUCT          |qmail-lspawn |set     |Has /etc/passwd format. Set by
                  |             |        |qmail-lspawn after doing vauth_getpw()
------------------|-------------|--------|----------------------------------------
PWSTRUCT          |vdelivermail |used    |Uses the environment variable to fetch
                  |vfilter      |        |the passwd structure rather than from
                  |             |        |the database.
MDA               |vfilter      |used    |Executable to be called for delivering
                  |             |        |the mail. By default, vfilter calls
                  |             |        |vdelivermail. Command line arguments
                  |             |        |can also be specified in the environment
                  |             |        |variable
MAILCOUNT_LIMIT   |vdelivermail |used    |Max deliveries permitted for a user in
                  |             |        |a day.
MAILSIZE_LIMIT    |             |        |Max total size of mail delivery/day for
                  |             |        |a user.
OVERQUOTA_MAILSIZE|             |        |Maximum allowed size of mail when user
                  |             |        |is over quota
HOLDOVERQUOTA     |             |        |If set, vdelivermail will defer mails
                  |             |        |when user runs out of quota. The command
                  |             |        |defined by OVERQUOTA_CMD will be run.
                  |             |        |However, BOUNCE_FLAG and lastdeliver
                  |             |        |table will not be updated
MAILDIRFOLDER     |             |        |Alternate Folder to deliver incoming
                  |             |        |mail.
MTA               |             |        |Default MTA to use for injecting mails
                  |             |        |(currently qmail-inject or postfix)
------------------|-------------|--------|----------------------------------------
OVERQUOTA_CMD     |vdelivermail |used    |Command to be run when user becomes
                  |authindi     |        |overquota. Triggered during mail
                  |             |        |delivery or during IMAP/POP3
                  |             |        |authentication.
------------------|-------------|--------|----------------------------------------
INCLUDE_TRASH     |vdelivermail |used    |If set, vdelivermail will include trash
                  |             |        |in quota calculations.
------------------|-------------|--------|----------------------------------------
REAL_DOMAINS      |qmail-rspawn |used    |List of real domains separated by the
                  |qmail-lspawn |        |':' character. e.g.
                  |InLookup     |        |indimail.org:yahoo.com
                  |vfilter      |        |
                  |vdelivermail |        |
ALIAS_DOMAINS     |             |        |List of aliasdomain-realdomain pair
                  |             |        |separated by the ':' character. e.g.
                                indimail.in,indimail.org:yahoo.co.in,yahoo.com
------------------|-------------|--------|----------------------------------------
POSTAUTH          |authindi     |used    |Command to be run post successful
                  |systpass     |        |authentication. If return value is 2 or
                  |vchkpass     |        |3, the homedir gets set to the
                  |proxyimap    |        |environment variable TMP_MAILDIR if
                  |proxypop3    |        |defined else it gets set to the user's home
                  |             |        |directory.
                  |             |        |If the return value is 3, authindi will
                  |             |        |additionally display a message defined
                  |             |        |by the environment variable MSG_ONERROR
                  |             |        |(if defined) and will exit if the
                  |             |        |environment variable EXIT_ONERROR is
                  |             |        |defined.
TMP_MAILDIR       |authindi     |used    |Home directory set for imap/pop3 if the
                  |proxyimap    |        |command defined by POSTAUTH exits with 2
                  |proxypop3    |        |or 3
MSG_ONERROR       |             |        |Message displayed to IMAP/POP3 clients
                  |             |        |when script defined by POSTAUTH exits
                  |             |        |with 2 or 3
EXIT_ONERROR      |             |        |If the command defined by POSTAUTH
                  |             |        |environment variable exits with 2 or 3
                  |             |        |and this environment variable is
                  |             |        |defined, IMAP/POP3 client will exit
                  |             |        |preventing the user from accessing
                  |             |        |mailbox
AUTHSERVICE       |authindi     |set     |imap, pop3 or webmail
PROTOCOL          |imaplogin    |set     |Set to IMAP or SMAP1 by imaplogin
                  |pop3login    |        |Set to POP3 by pop3login
------------------|-------------|--------|----------------------------------------
DESTPORT          |proxyimap    |used    |Used to determine whether the
                  |proxypop3    |        |destination port is imap or pop3. The
                  |authindi     |        |format is either imap:port_num or
                  |             |        |pop3:port_num, where port_num is a port
                  |             |        |on which either IMAP or POP3 server is
                  |             |        |listening.
NOLASTAUTH        |             |        |If set, lastauth insert is disabled
                  |             |        |during authentication.
MIGRATEUSER       |             |        |Program to be run once (first time) when
                  |             |        |the user logs in successfully
                  |             |        |(successful authentication).
MIGRATEFLAG       |             |        |Zero bytes file created in User's
                  |             |        |Maildir to figure out if the migration
                  |             |        |program defined by environment variable
                  |             |        |MIGRATEUSER has been run.
ACTIVATEMAIL      |             |        |Specifies the default name of the
                  |             |        |activation mail in the bulk mail
                  |             |        |directory.
WELCOMEMAIL       |             |        |Specifies the default name of the
                  |             |        |welcome mail in the bulk mail directory.
BULK_MAILDIR      |             |        |Constitutes part of the bulk mail
                  |             |        |directory. e.g. for indi.com the bulk
                  |             |        |mail directory will be
                  |             |        |indimail~/control/indi.com/$BULK_MAILDIR
BULK_HOST         |             |        |Environment variables to be set when the
                  |             |        |'bulkmail' table lies on a remote MySQL
                  |             |        |host.
BULK_VPORT        |             |        |Port for the 'bulkmail' MySQL
BULK_SOCKET       |             |        |Socket for the 'bulkmail' MySQL
BULK_USER         |             |        |User for the 'bulkmail' MySQL
BULK_PASSWD       |             |        |Password for the 'bulkmail' MySQL
BULK_DATABASE     |             |        |Database for the 'bulkmail' MySQL
MIN_LOGIN_INTERVAL|             |        |Minimum time permitted between two
                  |             |        |successful authentication.
                  |             |        |Authentication requests made before this
                  |             |        |teme elapsed are rejected. To remove
                  |             |        |this restriction, set this to 0.
NORELAY           |             |        |If set, insert to table 'relay'
                  |             |        |after successful authentication
                  |             |        |is disabled. This in effect disables
                  |             |        |relaying (Roaming Users).
TCP_FILE          |             |        |File containing list of default tcprules
                  |             |        |to be applied. Default is
                  |             |        |/var/indimail/etc/tcp.smtp.
OPEN_SMTP         |             |        |File containing list of tcprules for IP
                  |             |        |addresses of users who have
                  |             |        |authenticated in the past
                  |             |        |RELAY_CLEAR_MINUTES. Default
                  |             |        |is /var/indimail/etc/open-smtp
------------------|-------------|--------|----------------------------------------
RELAY_TABLE       |authindi     |used    |MySQL table name containing user
                  |InLookup     |        |authentication timestamps for
                  |clearopensmtp|        |implementing POP/IMAP before SMTP.
------------------|-------------|--------|----------------------------------------
PASSWD_CACHE      |authindi     |used    |Enables Password caching. Improves
                  |InLookup     |        |performance for a very busy site. For
                  |vchkpass     |        |dormant sites, this should be turned off
                  |             |        |as passwd changes take time to get
                  |             |        |reflected.
                  |             |        |
                  |             |        |
QUERY_CACHE       |authindi     |used    |Enables Query caching by using inquery.
                  |InLookup     |        |Improves performance for a very busy site.
                  |vchkpass     |        |
                  |             |        |
                  |             |        |
------------------|-------------|--------|----------------------------------------
RELAY_CLEAR_MIN   |clearopensmtp|used    |No of minutes after which the
-UTES             |InLookup     |        |authentication request maintained in the
                  |vuserinfo    |        |relay table is expired. This is used for
                  |authindi     |        |sites using pop/imap before smtp
                  |vchkpass     |        |authentication
                  |proxyimap    |        |
                  |proxypop3    |        |
------------------|-------------|--------|----------------------------------------
DATA_TIMEOUT      |proxyimap    |used    |Used for timing out if no data flows
                  |proxypop3    |        |between the user's MUA and the proxy, or
                  |             |        |between the proxy and the actual
                  |             |        |IMAP/POP3 daemon.
SLEEPTIME         |             |        |Minimum duration between connection
                  |             |        |attempts, if connection is refused.
LEGACY_SERVER     |             |        |If the destination imap/pop3 server are
                  |             |        |not indimail then this needs to be set.
                  |             |        |The destination imap/pop3 server will
                  |             |        |always see proxy server's IP address
                  |             |        |regardless from where the user logs in.
------------------|-------------|--------|----------------------------------------
DOMAIN_LIMITS     |authindi     |used    |The vlimit structure is checked and the
                  |vadduser     |        |pw_gid field is OR'ed with the value
                  |vdeldomain   |        |fetched from the vlimit table. This
                  |             |        |allows domain wide limits to be set for
                  |             |        |users.
IMAPCLIENT        |proxyimap    |used    |If set, access to IMAP is granted
POP3CLIENT        |proxypop3    |used    |If set, access to POP3 is granted
------------------|-------------|--------|----------------------------------------
ADMIN_HOST        |adminclient  |used    |variables used to connect to indisrvr
                  |             |        |for adding users. Also used by
                  |             |        |adminclient for executing administration
                  |             |        |commands.
ADMIN_PORT        |proxypop3    |        |Port for connecting to indisrvr
ADMIN_USER        |proxyimap    |        |User for connecting to indisrvr
ADMIN_PASS        |             |        |Password for connecting to indisrvr
ADMIN_TIMEOUT     |             |        |Used to set timeout for executing any
                  |             |        |administration command by indisrvr
------------------|-------------|--------|----------------------------------------
HARD_QUOTA        |vadduser     |        |Default value of quota for user addition
                  |             |        |through vadduser (without -q option).
                  |             |        |
ALLOWCHARS        |vadduser     |used    |List of allowed characters in the
                  |             |        |username.
AVG_USER_QUOTA    |vfstab       |used    |value in bytes the average mailbox size
                  |             |        |for a user.
------------------|-------------|--------|----------------------------------------
CNTRL_HOST        |InLookup     |used    |Environment variables to be set when a
                  |qmail-rspawn |        |domain is extended across multiple
                  |qmail-lspawn |        |servers. These variables point to the
                  |vuserinfo    |        |central database which has the
                  |vserverinfo  |        |'hostcntrl' table. If both MASTER_HOST
                  |             |        |and CNTRL_HOST are defined all updates
                  |             |        |go to MASTER_HOST adn all queries go
                  |             |        |to CNTRL_HOST
CNTRL_USER        |             |        |User for connecting to MySQL database
CNTRL_PASSWD      |             |        |password for connecting to MySQL
                  |             |        |database
CNTRL_VPORT       |             |        |port for connecting to MySQL database
CNTRL_SOCKET      |             |        |socket for connecting to MySQL database
CNTRL_TABLE       |             |        |Table for storing user location
                  |             |        |default is 'hostcntrl'
CNTRL_DATABASE    |             |        |database on which table 'hostcntrl' is
                  |             |        |present. default is 'indimail'
MASTER_HOST       |             |        |Host to which all writes should go to
------------------|-------------|--------|----------------------------------------
INFIFO            |InLookup     |used    |Name of FIFO used for communicating with
                  |qmail-smtpd  |        |InLookup. InLookup pools connections to
                  |authindi     |        |MySQL and provides the interface between
                  |proxyimap    |        |IndiMail and MySQL
                  |proxypop3    |        |
                  |inquerytest  |        |
------------------|-------------|--------|----------------------------------------
DEBUG             |InLookup     |used    |Enables verbose debugging
                  |vckpass      |        |
EDITOR            |dbinfo       |used    |Editor to use for editing the MCD file
HOME              |mate         |used    |These programs uses the HOME environment
                  |osh          |        |variable to switch its CWD.
                  |supernotepad |        |
                  |secpanel     |        |
                  |lite         |        |
TABLE_NAME        |osh          |used    |Access control file for granting program
                  |             |        |specific access to users.
TERM              |osh          |used    |Initialize various escape sequence for
                  |             |        |terminal handling
                  |logtop       |        |
MAIL              |maildir2mbox |used    |mbox file name
MAILDIR           |maildirwatch |used    |These programs use the MAILDIR
                  |             |        |environment to select the Maildir
MAILTMP           |maildir2mbox |used    |Temporary file that maildir2mbox can
                  |             |        |overwrite
MCDFILE           |InLookup     |used    |Mail Control Definition file. Specifies
                  |dbinfo       |        |the list of all MySQL servers
                  |vuserinfo    |        |participating in a clustered setup.
                  |vserverinfo  |        |
MYSQL_TABLE       |             |used    |Name of the default indimail
                  |             |        |authentication table containing active
                  |             |        |users. If not set, this defaults to
                  |             |        |'indimail'
MYSQL_INACTIVE_TAB|             |        |Name of the default indimail
-LE               |             |        |authentication table containing inactive
                  |             |        |users. If not set, this defaults to
                  |             |        |'indibak'
MAXADDR           |chowkidar    |used    |Number of addresses to load in chowkidar
------------------|-------------|--------|----------------------------------------
TCPLOCALHOST      |tcpclient    |set     |The domain name of the local host. If
                  |tcpserver    |        |there is no currently available domain
                  |             |        |name for the local IP address,
                  |             |        |TCPLOCALHOST is not set
TCPLOCALIP        |             |        |The IP address of the local host in
                  |             |        |dotted-decimal form
TCPLOCALPORT      |             |        |The local TCP port numer, in decimal
TCPREMOTEPORT     |             |        |The remote TCP port number.
------------------|-------------|--------|----------------------------------------
TCPREMOTEHOST     |tcpclient    |set     |The domain name of the remote host, with
                  |tcpserver    |        |uppercase letters  converted to
                  |tcprulescheck|        |lowercase. If there is no currently
                  |             |        |available domain name for the remote IP
                  |             |        |address, TCPREMOTEHOST is not set.
TCPREMOTEINFO     |             |        |A connection-specific string, perhaps a
                  |             |        |username, supplied by the remote host
                  |             |        |via 931/1413/IDENT/TAP. If the remote
                  |             |        |host did not supply connection
                  |             |        |information, TCPREMOTEINFO is not set.
------------------|-------------|--------|----------------------------------------
TCPREMOTEIP       |tcpclient    |set     |The IP address of the remote host.
                  |tcpserver    |        |
                  |tcprulescheck|        |
                  |rblsmtpd     |        |
------------------|-------------|--------|----------------------------------------
POST_HANDLE       |vadddomain   |used    |Used to set the path to program that
                  |vdeldomain   |        |will be executed on successful completion
                  |vrenamedomain|        |of the program. If not set, program with
                  |vadduser     |        |the same name as that of the calling
                  |vdeluser     |        |program will be executed in the directory
                  |vrenameuser  |        |INDIMAIL/libexec. If the program exists,
                  |vmoveuser    |        |then return status of the handle will be
                  |vpasswd      |        |returned
------------------|-------------|--------|----------------------------------------
COURIERTLS        |imapd/pop3d  |used    | Path to ssl enabler (sslerator / couriertls)
IMAP_STARTLS      |imapd        |        | If set to yes, STARTTLS is advertised
IMAP_TLS_REQUIRED |imapd        |        | If set to 1, STARTTLS is enforced
POP3_STARTLS      |pop3d        |        | If set to yes, STARTTLS is advertised
POP3_TLS_REQUIRED |pop3d        |        | If set to 1, STARTTLS is enforced
TLS_CERTFILE      |imapd/pop3d  |        | Path to certficate
TLS_PROTOCOL      |imapd/pop3d  |        | TLS1 or SSL3 depending on wheter you
                  |             |        | use straight SSL or STARTTLS
TLS_VERIFYPEER    |imapd/pop3d  |        | Set to NONE if you don't want to require
                  |             |        | a client certificate
BANNER            |sslerator    |        | Banner to display when STARTTLS is issued
------------------|-------------|--------|----------------------------------------
ACCT_INACT_EXPIRY |pam-multi    |used    |Max days a account can be inactive after
                  |pam-checkpwd |        |PAM authentication will expire the account
PASSWORD_EXPIRY   |(if using    |        |Max days within which the password has
                  |iauth.so)    |        |to be changed. After this, authentication
                  |             |        |will return failure
------------------|-------------|--------|----------------------------------------
.TE

Some of these environment variables have default values. The table below lists some of these.
.TS
l l.
Environ  Variable  | default value
-------------------|----------------
BULK_MAILDIR       | bulk_mail
DEFAULT_DOMAIN     | set by ./configure
BASE_PATH          | /home/mail
MYSQL_HOST         | localhost
MYSQL_VPORT        | 3306
MYSQL_SOCKET       | /tmp/mysql.sock
MYSQL_DATABASE     | indimail
MYSQL_TABLE        | indimail
MYSQL_INACTIVETABLE| indibak
MYSQL_PASSWD       |
MYSQL_USER         | indimail
QMAILDIR           | /var/indimail
TCP_FILE           | /var/indimail/etc/tcp.smtp
OPEN_SMTP_CUR_FILE | /var/indimail/etc/open-smtp
RELAY_TABLE        | relay
MCDFILE            | "mcdinfo" or /var/indimail/control/mcdinfo
INFIFO             | infifo or /var/indimail/control/inquery/infifo
.TE

.SH STARTUP
IndiMail uses svscan(8) to start, monitor and restart (if neccessary) all services needed
for proper functioning of email server. svscan is installed as an entry in /etc/inittab on
systems which use \fBinit(8)\fR. Some of the newer systems come with \fBupstart(8)\fR, in whih case,
svscan is installed in /etc/event.d. On MacOS the file indimail.plist in the directory
/System/Library/LaunchDaemons is used by launchctl to start IndiMail.

.PP
The program \fBinitsvc(1)\fR can be used to enable svscan to get automatically started on
system boot. All services are installed in /service which each directory representing a
service. These services are started and monitored by \fBsupervise(8)\fR. The table below
gives all the service directories in /service.

.TS
l l.
Directory            | Service Description
--------------------------------------------------------------------
clamd                | clam(8) antivirus
freshclam            | freshclam(1) clam signature update service
qscanq               | qscanq(8) virus scanner
qmail-smtpd.25       | qmail-smtpd(8) ESMTP service on port 25
qmail-smtpd.587      | qmail-smtpd(8) ESMTP Mssage Submission Port \fBrfc-2476(5)\fR
qmail-smtpd.366      | qmail-smtpd(8) ESMTP ODMR service on port 366
qmail-smtpd.465      | qmail-smtpd(8) ESMTPS service on port 465 (SSL)
qmail-qmtpd.209      | qmail-qmtpd(8) QMTP service on port 209
qmail-qmqpd.628      | qmail-qmqpd(8) QMTP service on port 628
qmail-send.25        | qmail-send(8) delivery service
fetchmail            | fetchmail(1) service
greylist.1999        | qmail-greyd(8) greylisting daemon
qmail-imapd.143      | imapd(8) IMAP service on port 143
qmail-imapd-ssl.993  | imapd(8) IMAPS service on port 993
proxy-imapd.4143     | imapd(8) IMAP proxy on port 4143
proxy-imapd-ssl.9143 | imapd(8) SSL enabled IMAP proxy on port 9143
qmail-pop3d.110      | pop3d(8) POP3 service on port 110
qmail-pop3d-ssl.995  | pop3d(8) POP3S service on port 995
proxy-pop3d.4110     | pop3d(8) POP3 proxy on port 4110
proxy-pop3d-ssl.9110 | pop3d(8) SSL enabled POP3 proxy on port 9110
indisrvr.4000        | indisrvr(8) IndiMail administration daemon
inlookup.infifo      | InLookup(8) Service
pwdlookup            | nssd(8) Name Service Switch Daemon
mysql.3306           | mysqld(8) MySQL daemon
qmail-poppass.106    | qmail-poppass(8) Poppassd protocol service
qmail-spamlog        | Spam logger service
.TE

The services on port 25, 587, 110, 4110, 143, 4143 support STARTTLS

You can use \fBsvc(8)\fR to start / stop individual services. To disable / enable all services,
you can use the \fBinitsvc(8)\fR command.

IndiMail attempts to be as portable as possible across different system. You can use
any of the following two commands to start IndiMail on all systems

.EX
 # service indimail start
 or 
 # initsvc -on
.EE

.SH POST Execution Handle
Some indimail programs have a post execution handle. A post execution handle is a program with
the same name as that of the calling program but in the directory INDIMAIL/libexec.
On successful completion, such programs execute the handle program and return
the status of the called handle program. If the handle program is not accessible, the return
status is zero. Normally, the handle program always gets executed from INDIMAIL/libexec
directory, but you can override the program called by setting the environment variable
\fBPOST_HANDLE\fR.

Post execution handle is useful when you want to achieve a task that is beyond the scope of IndiMail's
programs. These handle help you to extend the functionality of indimail programs when adding domains,
adding users, modifying a domain or modifying a user. These handles are passed arguments depending
on the arguments passed to the original program. See the section on \fBPOST HANDLE\fR in the
man page for the programs mentioned below having post execution handle.

Programs that support this post execution handle are vadddomain(1), vdeldomain(1), vrenamedomain(1),
vadduser(1), vdeluser(1), vrenameuser(1), vmoveuser(1), vpasswd(1).

The distribution includes two post execution handles \fBvadddomain\fR and \fBvadduser\fR.

.SH PROGRAMS
IndiMail has > 250 programs installed in INDIMAIL/bin, INDIMAIL/sbin.

.nr step 1 1
.IP \n[step] 4
vadddomain(1)      - Add a virtual domain
.sp -1
.IP \n+[step]
vmoddomain(1)      - Modify domain delivery instruction
.sp -1
.IP \n+[step]
vaddaliasdomain(1) - Add an alias domain
.sp -1
.IP \n+[step]
vrenamedomain(1)   - Rename a domain
.sp -1
.IP \n+[step]
vatrn(1)           - Set a domain for ODMR (RFC-2645)
.sp -1
.IP \n+[step]
vdeldomain(1)      - Delete a domain
.sp -1
.IP \n+[step]
vdominfo(1)        - Print domain information
.sp -1
.IP \n+[step]
printdir(1)        - Print domain directory structure layout
.sp -1
.IP \n+[step]
vmoddomlimits(1)   - Modify domain limits
.sp -1
.IP \n+[step]
vadduser(1)        - Add a user
.sp -1
.IP \n+[step]
vuserinfo(1)       - Display user information
.sp -1
.IP \n+[step]
vserverinfo(1)     - Display server information for a user
.sp -1
.IP \n+[step]
vpasswd(1)         - Change user password
.sp -1
.IP \n+[step]
qmail-poppass(1)   - Change user password using poppassd protocol
.sp -1
.IP \n+[step]
vdeluser(1)        - Delete a user
.sp -1
.IP \n+[step]
vmoduser(1)        - Modify user attributes
.sp -1
.IP \n+[step]
vsetuserquota(1)   - Set user disk quota
.sp -1
.IP \n+[step]
vmoveuser(1)       - Move user's homedir
.sp -1
.IP \n+[step]
vrenameuser(1)     - Rename a user
.sp -1
.IP \n+[step]
resetquota(8)      - Resets user's disk usage
.sp -1
.IP \n+[step]
valias(1)          - Add, modify, delete aliases
.sp -1
.IP \n+[step]
vcalias(8)         - Convert .qmail to IndiMail's alias database
.sp -1
.IP \n+[step]
vcaliasrev.sh(8)   - Convert IndiMail's alias database to .qmail
.sp -1
.IP \n+[step]
vgroup(1)          - Add, modify, delete groups
.sp -1
.IP \n+[step]
vacation(8)        - Set vacation response.
.sp -1
.IP \n+[step]
autoresponder      - Rate/Time limited autoresponder for IndiMail
.sp -1
.IP \n+[step]
vsmtp(8)           - Add, modify, delete SMTP routes
.sp -1
.IP \n+[step]
vipmap(1)          - Map an ip address to a virtual domain
.sp -1
.IP \n+[step]
vcfilter(1)        - Add, modify, delete vfilter
.sp -1
.IP \n+[step]
hostcntrl(8)       - Add, modify, delete hostcntrl entries
.sp -1
.IP \n+[step]
vhostid(8)         - Add, modify, delete hostid
.sp -1
.IP \n+[step]
dbinfo(8)          - Display database information for all IndiMail servers
.sp -1
.IP \n+[step]
ipchange(8)        - Change IP address of an IndiMail server
.sp -1
.IP \n+[step]
vbulletin(1)       - Set instant bulletin for IndiMail users
.sp -1
.IP \n+[step]
vfstab(8)          - Add, modify, delete fstab entries
.sp -1
.IP \n+[step]
execmysql          - Execute MySQL client on an IndiMail MySQL server
.sp -1
.IP \n+[step]
chowkidar(8)       - IndiMail's Spam Guard
.sp -1
.IP \n+[step]
logmonitor(8)      - Utility for real time monitoring of logs
.sp -1
.IP \n+[step]
controlsync        - Utility to maintain IndiMail's control file in sync
.sp -1
.IP \n+[step]
updatefile         - Update an IndiMail control file
.sp -1
.IP \n+[step]
vfilter(8)         - Filter mail before delivery using vfilter mechanism
.sp -1
.IP \n+[step]
vdelivermail(8)    - Deliver mails to Maildir
.sp -1
.IP \n+[step]
postdel(8)         - Deliver mails to Maildir if using postfix as MTA
.sp -1
.IP \n+[step]
proxyimap(8)       - IMAP proxy to connect to a server in a cluster setup
.sp -1
.IP \n+[step]
proxypop3(8)       - POP3 Proxy to connect to a server in a cluster setup
.sp -1
.IP \n+[step]
vproxy(8)          - Generic Proxy utility
.sp -1
.IP \n+[step]
vchkpass(8)        - IndiMail's checkpassword utility
.sp -1
.IP \n+[step]
systpass(8)        - checkpassword utility to authenticate against shadow
.sp -1
.IP \n+[step]
ldap-checkpwd(8)   - checkpassword utility to authenticate against LDAP
.sp -1
.IP \n+[step]
InLookup(8)        - IndiMail's name lookup daemon
.sp -1
.IP \n+[step]
inquerytest(8)     - Utility to test inlookup queries
.sp -1
.IP \n+[step]
indiversion(1)     - Display version information for all IndiMail programs
.sp -1
.IP \n+[step]
versioninfo(1)     - Display version information for all IndiMail programs
.sp -1
.IP \n+[step]
hostsync(8)        - Sync uncommited entries in a IndiMail cluster
.sp -1
.IP \n+[step]
clearopensmtp(8)   - remove stale IPs authorized for pop before SMTP
.sp -1
.IP \n+[step]
updaterules(8)     - Rebuild tcp.smtp.cdb with IP address open for relay.
.sp -1
.IP \n+[step]
vreorg(8)          - Do reorg of IndiMail's database for speed optimization
.sp -1
.IP \n+[step]
vdeloldusers(8)    - Delete inactive users, trash and other housekeeping
.sp -1
.IP \n+[step]
indisrvr(8)        - Secure server to run commands on an IndiMail cluster
.sp -1
.IP \n+[step]
adminclient(8)     - Client for connecting to indisrvr
.sp -1
.IP \n+[step]
sslerator          - TLS/SSL protocol wrapper
.sp -1
.IP \n+[step]
mgmtpass(8)        - Utility for managing admin users
.sp -1
.IP \n+[step]
vpriv(8)           - Set program access rights for indimail admin users.
.sp -1
.IP \n+[step]
osh(8)             - Operator Shell
.sp -1
.IP \n+[step]
flash(1)           - A menu shell with hotkeys and process group management
.sp -1
.IP \n+[step]
altermime          - MIME encoded email pack alteration too
.sp -1
.IP \n+[step]
ripmime            - email attachment / decomposition tool
.sp -1
.IP \n+[step]
mpack              - pack a file in MIME format
.sp -1
.IP \n+[step]
munpack            - unpack messages in MIME or split-uuencode format
.sp -1
.IP \n+[step]
nssd               - Name Service Switch daemon for IndiMail
.sp -1
.IP \n+[step]
pam-checkpwd       - PAM-based checkpassword program

.SH UCSPI-TCP

.nr step 1 1
.IP \n[step] 4
tcpserver     - accepts incoming TCP connections
.sp -1
.IP \n+[step]
tcpcat        - prints data from a remote host
.sp -1
.IP \n+[step]
tcpclient     - creates an outgoing TCP connection
.sp -1
.IP \n+[step]
tcp-env       - set up TCP-related environment variables
.sp -1
.IP \n+[step]
tcprules      - compiles rules for \fBtcpserver\fR(1)
.sp -1
.IP \n+[step]
tcprulescheck - checks tcprules
.sp -1
.IP \n+[step]
addcr         - inserts a CR (\015) before each LF (\012)
.sp -1
.IP \n+[step]
delcr         - removes a CR (\015) at the end of each line of input
.sp -1
.IP \n+[step]
fixcrio       - inserts missing CRs at the ends of lines
.sp -1
.IP \n+[step]
argv0         - runs a program with a specified 0th argument
.sp -1
.IP \n+[step]
date@         - prints the date on a remote host
.sp -1
.IP \n+[step]
finger@       - gets user information from a remote host
.sp -1
.IP \n+[step]
http@         - gets a web page from a remote host
.sp -1
.IP \n+[step]
who@          - prints the list of active users on a remote host
.sp -1
.IP \n+[step]
mconnect      - connect to a remote SMTP server
.sp -1
.IP \n+[step]
rblsmtpd      - block mail from rbl listed site
.sp -1
.IP \n+[step]
recordio      - record the input/output of a program
.sp -1
.IP \n+[step]
maildirserial - send a maildir through a client
.sp -1
.IP \n+[step]
maildirqmtp   - send a maildir through a QMTP
.sp -1
.IP \n+[step]
maildircmd    - pipe a maildir through a command
.sp -1
.IP \n+[step]
maildirsmtp   - send a maildir through a SMTP
.sp -1
.IP \n+[step]
serialcmd     - Pipe messages through a command
.sp -1
.IP \n+[step]
serialqmtp    - Blast messages to QMTP
.sp -1
.IP \n+[step]
serialsmtp    - Blast messages to SMTP

.SH Daemontools

.nr step 1 1
.IP \n[step] 4
envdir        - run program with env according to files in a directory
.sp -1
.IP \n+[step]
envuidgid     - run program with env variables with an account's uid, gid
.sp -1
.IP \n+[step]
setuidgid     - run program under a specified account's uid and gid
.sp -1
.IP \n+[step]
supervise     - starts and monitors a service
.sp -1
.IP \n+[step]
svc           - controls services monitored by \fBsupervise\fR(8)
.sp -1
.IP \n+[step]
svok          - checks whether \fBsupervise\fR(8) is running
.sp -1
.IP \n+[step]
svscan        - starts and monitors a collection of services
.sp -1
.IP \n+[step]
svscanboot    - starts svscan(8) in the service directory
.sp -1
.IP \n+[step]
svstat        - prints the status of services monitored by \fBsupervise\fR(8)
.sp -1
.IP \n+[step]
logselect     - Select portions of log
.sp -1
.IP \n+[step]
mlmatchup     - collect info on messages and deliveries through multilog
.sp -1
.IP \n+[step]
matchup       - collect info on messages and deliveries
.sp -1
.IP \n+[step]
multilog      - qmail/indimail logging utility
.sp -1
.IP \n+[step]
multitail     - watch output sent to a file
.sp -1
.IP \n+[step]
tai64n        - puts a precise timestamp on each line
.sp -1
.IP \n+[step]
tai64nlocal   - convert TAI64N timestamps to a human-readable format
.sp -1
.IP \n+[step]
tai64nunix    - convert TAI64N timestamps to fractional secs since epoch
.sp -1
.IP \n+[step]
teepipe       - copy stdin to a program and stdout
.sp -1
.IP \n+[step]
qfilelog      - log messages to a single file
.sp -1
.IP \n+[step]
splogger      - make entries in syslog
.sp -1
.IP \n+[step]
fghack        - is an anti-backgrounding tool
.sp -1
.IP \n+[step]
pgrphack      - runs a program in a separate process group
.sp -1
.IP \n+[step]
softlimit     - runs another program with new resource limits
.sp -1
.IP \n+[step]
multipipe     - supervise an pipeline of commands in a directory
.sp -1
.IP \n+[step]
spipe         - supervise an pipeline of commands
.sp -1
.IP \n+[step]
setlock       - runs another program with a file locked
.sp -1
.IP \n+[step]
readproctitle - maintains a rotated log in memory for inspection by ps(1)
.sp -1
.IP \n+[step]
qmail-log     - the qmail activity record
.sp -1
.IP \n+[step]
xqp           - locate a message given its qp
.sp -1
.IP \n+[step]
xrecipient    - locate all deliveries to one recipient
.sp -1
.IP \n+[step]
xsender       - locate all messages from one sender
.sp -1
.IP \n+[step]
columnt       - align columns in a table

.SH 822mess

.nr step 1 1
.IP \n[step] 4
822print        - print a mail message
.sp -1
.IP \n+[step]
822headerok     - Check if email message header is 822-compliant
.sp -1
.IP \n+[step]
822header       - print the header of a mail message
.sp -1
.IP \n+[step]
822addr         - extract 822 headers with values from email
.sp -1
.IP \n+[step]
822body         - print the body of a mail message
.sp -1
.IP \n+[step]
822headerfilter - filter message header through a program
.sp -1
.IP \n+[step]
822bodyfilter   - filter message body through a program
.sp -1
.IP \n+[step]
822date         - print the date in a mail message
.sp -1
.IP \n+[step]
822field        - print the value of a header field in a mail message
.sp -1
.IP \n+[step]
822fields       - extract 822 field values from email headers
.sp -1
.IP \n+[step]
822received     - print the Received fields in a mail message

.SH dot-qmail
.nr step 1 1
.IP \n[step] 4
autoresponder  - Rate and time limited autoresponder for qmail/indimail
.sp -1
.IP \n+[step]
qreceipt       - respond to delivery notice requests
.sp -1
.IP \n+[step]
replier        - Reply to messages through external program
.sp -1
.IP \n+[step]
bouncesaying   - perhaps bounce each incoming message
.sp -1
.IP \n+[step]
condredirect   - perhaps redirect mail to another address
.sp -1
.IP \n+[step]
condtomaildir  - Feed message to program and perhaps store message
.sp -1
.IP \n+[step]
forward        - forward new mail to one or more addresses
.sp -1
.IP \n+[step]
dot-forward    - read a .forward file under qmail
.sp -1
.IP \n+[step]
filterto       - perhaps redirect mail to another address
.sp -1
.IP \n+[step]
except         - reverse the exit code of a program
.sp -1
.IP \n+[step]
preline        - prepend lines to message
.sp -1
.IP \n+[step]
rrforward      - round-robin message delivery
.sp -1
.IP \n+[step]
maildirdeliver - deliver a mail message to a maildir
.sp -1
.IP \n+[step]
fastforward    - forward mail according to a cdb database
.sp -1
.IP \n+[step]
ifaddr         - match address
.sp -1
.IP \n+[step]
checkaddr      - match address on addresses supplied on standard input
.sp -1
.IP \n+[step]
iftocc         - match to or cc
.sp -1
.IP \n+[step]
iftoccfrom     - match to, cc or from
.sp -1
.IP \n+[step]
checkdomain    - match domain on addresses supplied on standard input
.sp -1
.IP \n+[step]
newaliases     - rebuild the data base for the mail aliases file
.sp -1
.IP \n+[step]
setmaillist    - create a binary mailing list
.sp -1
.IP \n+[step]
printmaillist  - print the contents of a binary mailing list
.sp -1
.IP \n+[step]
setforward     - create a forwarding database
.sp -1
.IP \n+[step]
printforward   - print the instructions in a forwarding database
.sp -1
.IP \n+[step]
newinclude     - create a binary mailing list from an :include: file

.SH qmail

.nr step 1 1
.IP \n[step] 4
ofmipd          - accept outgoing mail through OFMIP
.sp -1
.IP \n+[step]
ofmipname       - build a name-address database for ofmipd
.sp -1
.IP \n+[step]
qmail-daemon    - turn on qmail delivery with multiple queues
.sp -1
.IP \n+[step]
qmail-start     - turn on qmail delivery
.sp -1
.IP \n+[step]
qmail-smtpd     - receive mail via SMTP
.sp -1
.IP \n+[step]
swaks           - SMTP transaction tester
.sp -1
.IP \n+[step]
qmail-sql       - prepare data in MySQL for \fBqmail-smtpd\fR(8)
.sp -1
.IP \n+[step]
qmail-cdb       - prepare data in cdb format for \fBqmail-smtpd\fR(8), and \fBspawn-filter\fR(8)
.sp -1
.IP \n+[step]
recipient-cdb   - prepare recipients for qmail-smtpd
.sp -1
.IP \n+[step]
qmail-qmqpc     - queue a mail message via QMQP
.sp -1
.IP \n+[step]
qmail-qmqpd     - receive mail via QMQP
.sp -1
.IP \n+[step]
qmail-qmtpd     - receive mail via QMTP
.sp -1
.IP \n+[step]
qmail-lspawn    - schedule local deliveries
.sp -1
.IP \n+[step]
qmail-local     - deliver or forward a mail message
.sp -1
.IP \n+[step]
qmail-rspawn    - schedule remote deliveries
.sp -1
.IP \n+[step]
qmail-remote    - send mail via SMTP / ESMTP
.sp -1
.IP \n+[step]
qmail-poppass   - change passwords from across the network
.sp -1
.IP \n+[step]
qmail-clean     - clean up the queue directory
.sp -1
.IP \n+[step]
qmail-send      - deliver mail messages from the queue
.sp -1
.IP \n+[step]
qmail-todo      - process todo messages from the queue
.sp -1
.IP \n+[step]
spawn-filter    - Interceptor for qmail-local / qmail-remote
.sp -1
.IP \n+[step]
mailsubj        - send a mail message with a subject line
.sp -1
.IP \n+[step]
predate         - Prepend RFC 822 compliant Date header to data on stdin
.sp -1
.IP \n+[step]
datemail        - Insert local time in RFC 822 Date header before injecting mail
.sp -1
.IP \n+[step]
qmail-inject    - inject mail in the queue
.sp -1
.IP \n+[step]
new-inject      - preprocess a mail message before injecting
.sp -1
.IP \n+[step]
sendmail        - an electronic mail transport agent
.sp -1
.IP \n+[step]
qmail-tcpok     - clear TCP timeout tabl
.sp -1
.IP \n+[step]
qmail-tcpto     - print TCP timeout table
.sp -1
.IP \n+[step]
qmail-qread     - list outgoing messages, recipients, summarize queue stats
.sp -1
.IP \n+[step]
qmail-rm        - Remove mails from Queue
.sp -1
.IP \n+[step]
qpq             - Print qmail queue contents
.sp -1
.IP \n+[step]
queue-fix       - Create/Repair qmail queue structure
.sp -1
.IP \n+[step]
qmail-queue     - queue a mail message for delivery
.sp -1
.IP \n+[step]
qmail-multi     - queue multiplexor and filter
.sp -1
.IP \n+[step]
qmail-qfilter   - front end for qmail-multi that does filtering
.sp -1
.IP \n+[step]
qmail-nullqueue - send mail to /dev/null
.sp -1
.IP \n+[step]
qmail-dk        - Domainkey sign/verify and queue message for delivery
.sp -1
.IP \n+[step]
dktest          - exercise the domainkeys library
.sp -1
.IP \n+[step]
dk-filter       - DK/DKIM sign/verify and queue message for deilvery
.sp -1
.IP \n+[step]
qmail-dkim      - DKIM sign/verify and queue message for delivery
.sp -1
.IP \n+[step]
dkim            - Exercise the DKIM library
.sp -1
.IP \n+[step]
dknewkey        - Generate a new DK/DKIM key
.sp -1
.IP \n+[step]
qmail-getpw     - give addresses to users
.sp -1
.IP \n+[step]
qmail-newmrh    - prepare morercpthosts for qmail-smtpd
.sp -1
.IP \n+[step]
qmail-newu      - prepare address assignments for qmail-lspawn
.sp -1
.IP \n+[step]
qmail-pw2u      - build address assignments from a passwd file
.sp -1
.IP \n+[step]
qmailctl        - Control qmail mail delvery
.sp -1
.IP \n+[step]
qmail-showctl   - analyze the qmail configuration files
.sp -1
.IP \n+[step]
uacl            - test qmail-smtpd access list
.sp -1
.IP \n+[step]
maildirmake     - create a Maildir for incoming mail
.sp -1
.IP \n+[step]
qmaildirmake    - create a Maildir for incoming mail
.sp -1
.IP \n+[step]
maildirwatch    - look for new mail in a Maildir
.sp -1
.IP \n+[step]
maildir2mbox    - move mail from a Maildir to an mbox
.sp -1
.IP \n+[step]
mbox2maildir    - conver mbox to Maildir
.sp -1
.IP \n+[step]
greydaemon      - greylisting daemon (written in perl)
.sp -1
.IP \n+[step]
qmail-greyd     - greylisting daemon for IndiMail, qmail and netqmail
.sp -1
.IP \n+[step]
base64          - base64 encoding/decoding utility
.sp -1
.IP \n+[step]
uarf            - Abuse Report Format Generator

.SH CDB

.nr step 1 1
.IP \n[step] 4
cdbmake   - write cdb by reading series of encoded records on input
.sp -1
.IP \n+[step]
cdbdump   - read cdb in stdin and print database in \fBcdbmake\fR(1) format
.sp -1
.IP \n+[step]
cdbget    - search for records in cdb
.sp -1
.IP \n+[step]
cdbgetm   - search for multiple records matching a key in cdb
.sp -1
.IP \n+[step]
cdbstats  - read cdb on stdin and print statistics
.sp -1
.IP \n+[step]
cdbtest   - read cdb on stdin and test it

.SH Miscellaneous

These programs have been borrowed from external Open Source Projects and they add significant
value to the working of the IndiMail server.

.nr step 1 1
.IP \n[step] 4
imapd         - Courier-IMAP server
.sp -1
.IP \n+[step]
pop3d         - Courier-POP3 server
.sp -1
.IP \n+[step]
couriertls    - Courier TLS/SSL protocol wrapper
.sp -1
.IP \n+[step]
maildirkw     - set maildir message keywords
.sp -1
.IP \n+[step]
maildiracl    - manage access control lists of courier-imap maildir
.sp -1
.IP \n+[step]
deliverquota  - deliver to a maildir with a quota
.sp -1
.IP \n+[step]
mkimapdcert   - create a test SSL certificate for IMAP over SSL
.sp -1
.IP \n+[step]
mkpop3dcert   - create a test SSL certificate for POP3 over SSL
.sp -1
.IP \n+[step]
bogofilter    - fast Bayesian spam filter
.sp -1
.IP \n+[step]
bogolexer     - Utility program for separating email messages into tokens
.sp -1
.IP \n+[step]
bogotune      - find optimum parameter settings for bogofilter
.sp -1
.IP \n+[step]
bogoupgrade   - upgrades bogofilter database to current version
.sp -1
.IP \n+[step]
bogoutil      - Dumps, loads, and maintains bogofilter database files
.sp -1
.IP \n+[step]
bf_compact    - shell script to compact a bogofilter directory
.sp -1
.IP \n+[step]
bf_copy       - shell script to copy a bogofilter working directory
.sp -1
.IP \n+[step]
bf_tar        - shell script to write a tar file of a bogofilter directory to stdout
.sp -1
.IP \n+[step]
fetchmail     - fetch mail from a POP, IMAP, ETRN, or ODMR-capable server
.sp -1
.IP \n+[step]
fetchmailconf - configure fetchmailrc
.sp -1
.IP \n+[step]
freshclam     - update clamd virus database
.sp -1
.IP \n+[step]
clamd         - an anti-virus daemon
.sp -1
.IP \n+[step]
qscanq        - qmail virus scanner
.sp -1
.IP \n+[step]
run-cleanq    - request cleanq to be run
.sp -1
.IP \n+[step]
cleanq        - clean up qscanq work directory
.sp -1
.IP \n+[step]
sigtool       - signature and database management tool

.SH FUN STUFF

.nr step 1 1
.IP \n[step] 4
fortune - print a random, hopefully interesting, adage
.sp -1
.IP \n+[step]
unstr   - dump strings in pointer order
.sp -1
.IP \n+[step]
strfile - create a random access file for storing strings
.sp -1
.IP \n+[step]
randstr - fetch a random text string from a specified file

.PP
Apart from the above, IndiMail provides many more programs which can work with qmail without
needing IndiMail to be installed. The list of such programs not listed here are being compiled
and will be available in the near future.

.SH Mailing lists
There are four Mailing Lists for IndiMail

.TP 5
1. indimail-support - mailing list for support
indimail-support@lists.sourceforge.net

Subscribe for Support at https://lists.sourceforge.net/lists/listinfo/indimail-support.
Old discussions can be seen at
https://sourceforge.net/mailarchive/forum.php?forum_name=indimail-support
.TP 5
2. indimail-devel - mailing list to discuss IndiMail development
indimail-devel@lists.sourceforge.net

Subscribe at https://lists.sourceforge.net/lists/listinfo/indimail-devel
Old discussions can be seen at
https://sourceforge.net/mailarchive/forum.php?forum_name=indimail-devel
.TP 5
3. indimail-announce - List to announce New Releases or patches
Subscribe at http://groups.google.com/group/indimail
.TP 5
4. Archive at Google - http://groups.google.com/group/indimail
This groups acts as a remote archive for indimail-support and indimail-devel.

.PP
There is also a Project Tracker for IndiMail (Bugs, Feature Requests, Patches, Support Requests) at
http://sourceforge.net/tracker/?group_id=230686

You can also get titbits about IndiMail at
.TP 5
Tips&Tricks - http://indimail.blogspot.com
.TP 5
twitter     - http://twitter.com/indimail
.TP 5
facebook    - http://www.facebook.com/pages/indimail/88063516703?_fb_noscript=1
.TP 5
sourceforge - https://sourceforge.net/apps/laconica/indimail/

.SH Download/Repository
IndiMail provides the package in both source and binary forms. Installation from the source
requires you to download other packages from the respective websites apart from the indimail
core package. The indimail package contains a patch directory which allows you to add features
to qmail, ucspi-tcp, courier-imap, etc. Details for building IndiMail from source can be read
in the INSTALL document provided with the source package. Many users may find this complicated
and hence binary packages are also provided which can be downloaded from the RPM repo mentioned
below.

.TP 5
Source Download - http://sourceforge.net/projects/indimail/
.TP 5
Git Repository  - http://indimail.git.sourceforge.net/
.TP 5
Stable RPM Repo - http://download.opensuse.org/repositories/home:/indimail/
.TP 5
Raw RPM Repo    - http://download.opensuse.org/repositories/home:/mbhangui/
.PP
IndiMail uses openSUSE Build service to build the RPM whenever there is a new release.
Currently, the list of supported distributions for IndiMail RPM (for both 32 and 64 bit) are

    * SUSE
          o openSUSE 11.2
          o openSUSE 11.1
          o openSUSE 11.0
          o SUSE Linux Enterprise 11
          o SUSE Linux Enterprise 10
          o openSUSE Factory

    * Red Hat
          o Fedora 12
          o Fedora 11
          o Fedora 10
          o Red Hat Enterprise Linux 5
          o CentOS 5

    * Mandriva Linux
          o Mandriva 2010
          o Mandriva 2009.1
          o Mandriva 2009

You can also use \fByum(8)\fR to install IndiMail by downloading the repo file and
importing the RPM key. e.g. for Fedora 12 one could do the following

.EX
# wget -O /etc/yum.repos.d/indimail.repo \\
 http://download.opensuse.org/repositories/home:/indimail/Fedora_12/home:indimail.repo

# rpm --import \\
 http://download.opensuse.org/repositories/home:/indimail/Fedora_12/repodata/repomd.xml.key

# yum install indimail.x86_64
    or
# yum install indimail.i386
.EE

.SH "SEE ALSO"
dbinfo(8),
inlookup(8),
pam-multi(8),
vhostid(8),
vsmtp(8),
vreorg(8),
hostcntrl(1),
vadduser(1),
vdeluser(1),
initsvc(1),
sslerator(1),
svscan(8),
supervise(8),
qmailctl(8),
svctool(8),
autoresponder(1),
rpm(8),
yum(8),
rfc-2645(5)
