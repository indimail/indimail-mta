#!/bin/sh
prefix=@indimaildir@
rm=/bin/rm

ID=`id -u`
if [ $ID -ne 0 ] ; then
	echo "You are not root" >&2
	exit 1
fi

case "$1" in
    configure)
		if [ " $2" = " " ] ; then
		echo "installing version 1.8"
		else
		echo "upgrading to version $2"
		fi
    ;;

    abort-upgrade|abort-remove|abort-deconfigure)
	exit 0
    ;;

    *)
        echo "postinst called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

#
# We need to do this for debian. SIGH!!
#

if [ -f /tmp/indium.upgrade ] ; then # upgrade
	if [ -f ${prefix}/boot/rpm.init ] ; then
		/sbin/ldconfig
		echo "Running Custom Upgrade Script"
		/bin/sh ${prefix}/boot/rpm.init upgrade
	fi
	${rm} -f /tmp/indium.upgrade
	exit 0
fi
${rm} -f /tmp/indium.install /tmp/indium.upgrade
# Recreate ld.so links and cache
echo "ldconfig..."
if [ -d ${sysconfdir}/ld.so.conf.d ] ; then
	(
		echo @indimaildir@/lib
	) > ${sysconfdir}/ld.so.conf.d/indium-`uname -m`.conf
fi
/sbin/ldconfig
